////#! /usr/bin/env node
var menu = require('terminal-menu');
var _ = require('underscore');

setTimeout(function() {
  buildMenu();
}, 500);

function buildMenu() {
  var config = require('./menu-config');
  var mainMenu = menu({ width: 75, x: 4, y: 2});
  mainMenu.reset();

  mainMenu.write('Vivint Solar Jobs\n');
  mainMenu.write('------------------------------------------------------\n');

  config.forEach(function(option) {
    mainMenu.add(option.label);
  });

  mainMenu.on('select', function(label) {
    var option = _.find(config, function(option) {
      return option.label === label;
    });

    mainMenu.y = 0;
    mainMenu.reset();
    mainMenu.close();

    require('./' + option.module).run(buildMenu);
  });

  mainMenu.createStream().pipe(process.stdout);
}



process.on('error', function(err) {
  console.log(err);
});

